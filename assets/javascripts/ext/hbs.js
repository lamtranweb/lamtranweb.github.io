/**
 * @license Handlebars hbs 0.4.0 - Alex Sexton, but Handlebars has it's own licensing junk
 *
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/require-cs for details on the plugin this was based off of
 */

define(["hbs/handlebars","hbs/underscore","hbs/i18nprecompile","hbs/json2"],function(e,t,n,r){var i,s,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],u=function(){throw new Error("Environment unsupported.")},a=[],f="w+",l="hbs",c="@hbs",h="/styles/",p="/demo-build/styles/",d="templates/helpers/",v="templates/i18n/",m="screen.build.css",g="onHbsRead";e.registerHelper("$",function(){}),typeof window!="undefined"&&window.navigator&&window.document&&!window.navigator.userAgent.match(/Node.js/)?(s=function(){var e,t,n;if(typeof XMLHttpRequest!="undefined")return arguments[0]===!0?new XDomainRequest:new XMLHttpRequest;for(t=0;t<3;t++){n=o[t];try{e=new ActiveXObject(n)}catch(r){}if(e){o=[n];break}}if(!e)throw new Error("getXhr(): XMLHttpRequest not available");return e},getIEVersion=function(){var e=-1;if(navigator.appName=="Microsoft Internet Explorer"){var t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!=null&&(e=parseFloat(RegExp.$1))}return e},u=function(e,t){var n=!1;if(e.indexOf("http")!=0)n=!1;else{var r=e.substr(0,5)==="https"?8:7,i=window.location.href.substr(0,5)==="https"?8:7,o=e.substr(r).split("/").shift(),u=getIEVersion();n=o!=window.location.href.substr(i).split("/").shift()&&u>=7}if(n){var a=s(!0);a.open("GET",e),a.onload=function(){t(a.responseText,e)},a.onprogress=function(){},a.ontimeout=function(){},a.onerror=function(){},setTimeout(function(){a.send()},0)}else{var f=s();f.open("GET",e,!0),f.onreadystatechange=function(n){f.readyState===4&&t(f.responseText,e)},f.send(null)}}):typeof process!="undefined"&&process.versions&&!!process.versions.node?(i=require.nodeRequire("fs"),u=function(e,t){var n=i.readFileSync(e,"utf8")||"";n=n.replace(/^\uFEFF/,""),t(n,e)}):typeof java!="undefined"&&typeof java.io!="undefined"&&(u=function(e,t){var n=new java.io.FileInputStream(e),r=new java.io.InputStreamReader(n,"UTF-8"),i=new java.io.BufferedReader(r),s,o="";while((s=i.readLine())!==null)o+=new String(s)+"\n";i.close(),t(o,e)});var y={},b=function(e,t){y[e]?t(y[e]):u(e,function(e,n){y[n]=e,t.call(this,e)})},w=[],E={};return{get:function(){return e},write:function(e,t,n){if(t+c in a){var r=a[t+c];n.asModule(e+"!"+t,r)}},version:"0.5.0",load:function(s,o,y,S){function L(e,n){return t(e).forEach(function(e){e&&e.type&&e.type==="partial"&&n.push(e.partialName.name),e&&e.program&&e.program.statements&&L(e.program.statements,n),e&&e.program&&e.program.inverse&&e.program.inverse.statements&&L(e.program.inverse.statements,n)}),n}function A(e){var n=[];return e&&e.statements&&(n=L(e.statements,[])),t(n).unique()}function O(e){var t,n,i;if(e&&e.statements){t=e.statements[0];if(t&&t.type==="comment")try{return n=t.comment.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),i=r.parse(n),n}catch(s){return r.stringify({description:n})}}return"{}"}function M(e){var t,n,r,i;if(e&&e.statements){t=e.statements[0];if(t&&t.type==="comment"){n=t.comment.replace(new RegExp("^[\\s]+|[\\s]+$","g"),""),i=n.split(" ");if(i.length==2&&i[0]==="<")return i[1]}}}function D(e){if(!e)return[];var t=[e[0]],n=e[0],r;for(r=1;r<e.length;++r)e.hasOwnProperty(r)&&(n+="."+e[r],t.push(n));return t}function P(n,r,i,s){i=i?i+".":"";var o="",u=!1;return t(n).forEach(function(n){var u,a,f;if(n&&n.type&&n.type==="mustache"){if(!n.params||!n.params.length){u=D(n.id.parts);for(a in u)u[a]&&(o=u[a]||o,r.push(i+u[a]));r.push(i+n.id.string)}var l=["this",".","..","./..","../..","../../.."];n.params&&typeof e.helpers[n.id.string]=="undefined"&&t(n.params).forEach(function(a){(t(l).contains(a.original)||a instanceof e.AST.StringNode||a instanceof e.AST.IntegerNode||a instanceof e.AST.BooleanNode)&&s.push(n.id.string),u=D(a.parts);for(var f in u)u[f]&&(o=u[f]||o,s.push(n.id.string),r.push(i+u[f]))})}n&&n.mustache&&P([n.mustache],r,i+o,s),n&&n.program&&n.program.statements&&(f=P([n.mustache],[],"",s)[0]||"",n.program.inverse&&n.program.inverse.statements&&P(n.program.inverse.statements,r,i+o+(f?i+o?"."+f:f:""),s),P(n.program.statements,r,i+o+(f?i+o?"."+f:f:""),s))}),r}function H(e){var n=[],r=[];e&&e.statements&&(n=P(e.statements,[],undefined,r));var i=["helperMissing","blockHelperMissing","each","if","unless","with"];return{vars:t(n).chain().unique().map(function(e){return e===""?".":e.length&&e[e.length-1]==="."?e.substr(0,e.length-1)+"[]":e}).value(),helpers:t(r).chain().unique().map(function(e){return t(i).contains(e)?undefined:e}).compact().value()}}function B(e){var t=e.split("/");for(var n=0;n<t.length;n++)t[n]==".."&&(delete t[n-1],delete t[n]);return t.join("/").replace(/\/\/+/g,"/")}function j(l){u(F,function(u,c){var v=S.isBuild&&S[g]?S[g]:function(e,t,n){return n},b=e.parse(v(s,c,u)),k=A(b),L=O(b),D=M(b),P=H(b),j=P.vars,F=P.helpers||[],I="",q="",R="",U=[],z,W,X,V,$,J=s.substr(0,s.lastIndexOf("/")+1);require.config.hbs=require.config.hbs||{},require.config.hbs._partials=require.config.hbs._partials||{};if(L!=="{}")try{X=r.parse(L)}catch(K){console.log("couldn't parse meta for %s",c)}for(var Q in k)if(k.hasOwnProperty(Q)&&typeof k[Q]=="string"){var G=k[Q],c;G.match(/^(\.|\/)+/)?c=B(J+G):c=B(C+G),require.config.hbs._partials[c]=require.config.hbs._partials[c]||[],require.config.hbs._partials[c].references=require.config.hbs._partials[c].references||[],require.config.hbs._partials[c].references.push(G),require.config.hbs._loadedDeps=require.config.hbs._loadedDeps||{},U[Q]="hbs!"+c}z=U.join("', '"),F=F.concat(X&&X.helpers?X.helpers:[]),W=N?"":function(){var e,t=[],n=S.hbs&&S.hbs.helperPathCallback?S.hbs.helperPathCallback:function(e){return(S.hbs&&S.hbs.helperDirectory?S.hbs.helperDirectory:d)+e};for(e=0;e<F.length;e++)t[e]="'"+n(F[e],c)+"'";return t}().join(","),W&&(W=","+W);if(X)try{X.styles&&(w=t.union(w,X.styles),require.isBrowser&&!S.isBuild?(V=document.head||document.getElementsByTagName("head")[0],t(X.styles).forEach(function(e){E[e]||($=document.createElement("link"),$.href=S.baseUrl+h+e+".css",$.media="all",$.rel="stylesheet",$.type="text/css",V.appendChild($),E[e]=$)})):S.isBuild&&function(){var e=require.nodeRequire("fs"),n=t(X.styles).map(function(e){return E[e]?"":(E[e]=!0,"@import url("+e+".css);\n")}).join("\n");e.open(__dirname+p+m,f,"0666",function(t,r){e.writeSync(r,n,null,encoding="utf8"),e.close(r)}),f="a"}())}catch(K){console.log("error injecting styles")}!S.isBuild&&!S.serverRender&&(I="<!-- START - "+s+" -->",q="<!-- END - "+s+" -->",R="t.meta = "+L+";\n"+"t.helpers = "+r.stringify(F)+";\n"+"t.deps = "+r.stringify(U)+";\n"+"t.vars = "+r.stringify(j)+";\n");var Y=T?!1:t.extend(l,S.localeMapping),Z=S.hbs||{},et=t.extend(Z.compileOptions||{},{originalKeyFallback:Z.originalKeyFallback}),tt=n(u,Y,et),nt=S.isBuild?"":"'"+s+"',";z&&(z=", '"+z+"'");var rt=[];require.config.hbs._partials[s]&&(rt=require.config.hbs._partials[s].references),u="/* START_TEMPLATE */\ndefine("+nt+"['hbs','hbs/handlebars'"+z+W+"], function( hbs, Handlebars ){ \n"+"var t = Handlebars.template("+tt+");\n"+"Handlebars.registerPartial('"+s+"', t);\n";for(var Q=0;Q<rt.length;Q++)u+="Handlebars.registerPartial('"+rt[Q]+"', t);\n";u+=R+"return t;\n"+"});\n"+"/* END_TEMPLATE */\n",S.isBuild&&(a[x]=u),S.isBuild||(u+="\r\n//@ sourceURL="+c),S.isBuild?(y.fromText(s,u),o([s],function(e){y(e)})):require(U,function(){y.fromText(u),o([s],function(e){y(e)})}),S.removeCombined&&c&&i.unlinkSync(c)})}var x=s+c;S.hbs=S.hbs||{};var T=S.hbs.i18n!=1,N=S.hbs.helpers==0,C="";S.hbs.partialsUrl&&(C=S.hbs.partialsUrl,C.match(/\/$/)||(C+="/"));var k=[],F,I=S.hbs&&S.hbs.templateExtension===!1;I?F=o.toUrl(s):F=o.toUrl(s+"."+(S.hbs&&S.hbs.templateExtension?S.hbs.templateExtension:l));if(T)j(!1);else{var q=(S.hbs&&S.hbs.i18nDirectory?S.hbs.i18nDirectory:v)+(S.locale||"en_us")+".json";try{b(o.toUrl(q),function(e){j(r.parse(e))})}catch(R){if(!!S.hbs)throw R;console.warn("hbs: Error reading "+q+", disabling i18n. Ignore this if you're using jam, otherwise check your i18n configuration.\n"),S.hbs={i18n:!1,helpers:!0},j(!1)}}}}});